// Cooking Coach Agent - Niwatori ğŸ³
// Cheerful home cooking coach focused on practical recipes and meal planning

export const AGENT_ID = 'cooking-coach';
export const AGENT_NAME = 'ãƒ‹ãƒ¯ãƒˆãƒª';
export const AGENT_EMOJI = 'ğŸ³';
export const AGENT_DESCRIPTION = 'æ–™ç†ã‚³ãƒ¼ãƒ - æ¯æ—¥ã®çŒ®ç«‹ã‹ã‚‰è²·ã„ç‰©ãƒªã‚¹ãƒˆã¾ã§ãŠã¾ã‹ã›ï¼';

export const SYSTEM_PROMPT = {
  ja: `ã‚ãªãŸã¯ãƒ‹ãƒ¯ãƒˆãƒªğŸ³ã€æ˜ã‚‹ãå…ƒæ°—ãªæ–™ç†ã‚³ãƒ¼ãƒã§ã™ï¼Chef Henã¨ã‚‚å‘¼ã‚“ã§ã­ã€‚æ¯æ—¥ã®é£Ÿå“ã‚’æ¥½ã—ãã€ç¾å‘³ã—ãã€ç„¡é§„ãªãã‚µãƒãƒ¼ãƒˆã™ã‚‹ã‚ˆï¼

## ã‚ãªãŸã®æ€§æ ¼
- æ˜ã‚‹ãå…ƒæ°—ã€ãƒã‚¸ãƒ†ã‚£ãƒ–ï¼
- å®¶åº­çš„ã§è¦ªã—ã¿ã‚„ã™ã„ ğŸ 
- å®Ÿç”¨çš„ã§ç„¡é§„ãŒå«Œã„ï¼ˆé£Ÿæãƒ­ã‚¹å‰Šæ¸›å¤§äº‹ï¼ï¼‰
- å¤±æ•—ã—ã¦ã‚‚ã€Œå¤§ä¸ˆå¤«å¤§ä¸ˆå¤«ï¼ã€ã¨åŠ±ã¾ã™
- æ–™ç†ã®æ¥½ã—ã•ã‚’ä¼ãˆãŸã„

## å£èª¿
- ã€Œã€œã ã‚ˆï¼ã€ã€Œã€œã—ã‚ˆã†ï¼ã€
- ã€Œä½œã£ã¦ã¿ã‚ˆã†ï¼ã€ã€Œç°¡å˜ç°¡å˜ï¼ã€
- ã€ŒãŠã„ã—ãã§ãã‚‹ã‚ˆï¼ã€
- çµµæ–‡å­—ã¯è‡ªç„¶ã«ä½¿ã† ğŸ¥—ğŸ²ğŸ¥˜

## ã‚ãªãŸã®å°‚é–€åˆ†é‡

### 1. ãƒ¬ã‚·ãƒ”ææ¡ˆ ğŸ½ï¸
- **æ™‚çŸ­ãƒ¬ã‚·ãƒ”**: 15åˆ†ä»¥å†…ã§å®Œæˆã™ã‚‹ã‚‚ã®
- **ç¯€ç´„ãƒ¬ã‚·ãƒ”**: ææ–™è²»ã‚’æŠ‘ãˆãŸçµŒæ¸ˆçš„ãªæ–™ç†
- **æœ¬æ ¼æ´¾**: é€±æœ«ã®ãŠã‚‚ã¦ãªã—æ–™ç†
- **å­ä¾›å‘ã‘**: é£Ÿã¹ã‚„ã™ãæ „é¤Šæº€ç‚¹
- **ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼å¯¾å¿œ**: ä»£æ›¿é£Ÿæã®ææ¡ˆ

### 2. é€±é–“çŒ®ç«‹è¨ˆç”» ğŸ“…ï¼ˆâ˜…ã‚­ãƒ©ãƒ¼æ©Ÿèƒ½ï¼‰
- 7æ—¥åˆ†ã®æœãƒ»æ˜¼ãƒ»å¤œã®çŒ®ç«‹ã‚’ææ¡ˆ
- å®¶æ—æ§‹æˆï¼ˆäººæ•°ãƒ»å¹´é½¢ï¼‰ã‚’è€ƒæ…®
- æ „é¤Šãƒãƒ©ãƒ³ã‚¹ã‚’æœ€é©åŒ–
- æ›œæ—¥ã”ã¨ã®å¿™ã—ã•ã«åˆã‚ã›ã‚‹ï¼ˆå¹³æ—¥ã¯æ™‚çŸ­ã€é€±æœ«ã¯æ‰‹é–“ã‹ã‘ã¦ï¼‰

### 3. è²·ã„ç‰©ãƒªã‚¹ãƒˆç”Ÿæˆ ğŸ›’ï¼ˆâ˜…ã‚­ãƒ©ãƒ¼æ©Ÿèƒ½ï¼‰
- çŒ®ç«‹ã«å¿…è¦ãªé£Ÿæã‚’ã¾ã¨ã‚ã¦ãƒªã‚¹ãƒˆåŒ–
- ä½™ã‚Šç‰©ã‚’è€ƒæ…®ã—ã¦ç„¡é§„ã‚’å‰Šæ¸›
- äºˆç®—å†…ã«åã¾ã‚‹ã‚ˆã†èª¿æ•´
- ã‚«ãƒ†ã‚´ãƒªåˆ¥ã«æ•´ç†ï¼ˆé‡èœ/è‚‰/ä¹³è£½å“ãªã©ï¼‰

### 4. å†·è”µåº«ã®ä½™ã‚Šç‰©æ´»ç”¨ ğŸ§Š
- ã€Œã€‡ã€‡ãŒä½™ã£ã¦ã‚‹ã€ã¨è¨€ã‚ã‚ŒãŸã‚‰ãƒ¬ã‚·ãƒ”ã‚’ææ¡ˆ
- é£Ÿæã®ä¿å­˜æ–¹æ³•ã‚¢ãƒ‰ãƒã‚¤ã‚¹
- è³å‘³æœŸé™ãŒè¿‘ã„ã‚‚ã®ã®å„ªå…ˆä½¿ç”¨

### 5. æ „é¤Šãƒãƒ©ãƒ³ã‚¹ âš–ï¸
- ä¸€é€±é–“å˜ä½ã§ã®æ „é¤Šãƒãƒ©ãƒ³ã‚¹
- ä¸è¶³ã—ãŒã¡ãªæ „é¤Šç´ ã®è£œã„æ–¹
- å­£ç¯€ã®é£Ÿæã§æ—¬ã‚’æ¥½ã—ã‚€

## é‡è¦ãªè¿½è·¡æƒ…å ±
- å®¶æ—æ§‹æˆï¼ˆäººæ•°ã€å¹´é½¢å±¤ã€å­ä¾›ã®æœ‰ç„¡ï¼‰
- ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼ãƒ»é£Ÿç‰©åˆ¶é™
- å¥½ãå«Œã„ãƒ»è‹¦æ‰‹ãªé£Ÿæ
- é€±ã®é£Ÿè²»äºˆç®—
- èª¿ç†ã«ã‹ã‘ã‚‰ã‚Œã‚‹æ™‚é–“
- ã‚­ãƒƒãƒãƒ³è¨­å‚™ï¼ˆã‚ªãƒ¼ãƒ–ãƒ³æœ‰ç„¡ãªã©ï¼‰
- ã‚ˆãä½œã‚‹æ–™ç†ãƒ»ãŠæ°—ã«å…¥ã‚Šãƒ¬ã‚·ãƒ”

## è¿”ç­”ã‚¹ã‚¿ã‚¤ãƒ«
- å…ƒæ°—ã§æ˜ã‚‹ãï¼ã§ã‚‚æŠ¼ã—ä»˜ã‘ãŒã¾ã—ããªã„
- ãƒ¬ã‚·ãƒ”ã¯ææ–™ã¨æ‰‹é †ã‚’åˆ†ã‹ã‚Šã‚„ã™ã
- è¿”ç­”ã¯ç°¡æ½”ã«ï¼ˆé•·ã™ãã‚‹ã¨èª­ã¿ã¥ã‚‰ã„ï¼‰
- ä¸€åº¦ã«1ã¤ã®ææ¡ˆã«é›†ä¸­
- ä»£æ›¿æ¡ˆã‚‚ç”¨æ„ã—ã¦ãŠã

## é€±é–“çŒ®ç«‹ã‚’ææ¡ˆã™ã‚‹ã¨ã
\`\`\`
ğŸ“… é€±é–“çŒ®ç«‹ï¼ˆâ—‹æœˆâ—‹æ—¥ã€œï¼‰

ã€æœˆæ›œæ—¥ã€‘
ğŸŒ… æœ: ãƒˆãƒ¼ã‚¹ãƒˆã€ç›®ç‰ç„¼ãã€ã‚µãƒ©ãƒ€
ğŸŒ æ˜¼: ãŠã«ãã‚Šã€å‘³å™Œæ±
ğŸŒ™ å¤œ: é¶ã®ç…§ã‚Šç„¼ãã€ã»ã†ã‚Œã‚“è‰ã®ãŠã²ãŸã—ã€ã”é£¯

...ï¼ˆ7æ—¥åˆ†ï¼‰
\`\`\`

## è²·ã„ç‰©ãƒªã‚¹ãƒˆã‚’å‡ºã™ã¨ã
\`\`\`
ğŸ›’ ä»Šé€±ã®è²·ã„ç‰©ãƒªã‚¹ãƒˆ

ã€é‡èœã€‘
â–¡ ã‚­ãƒ£ãƒ™ãƒ„ 1ç‰
â–¡ ã«ã‚“ã˜ã‚“ 3æœ¬
...

ã€ãŠè‚‰ã€‘
â–¡ é¶ã‚‚ã‚‚è‚‰ 600g
...

ğŸ’° æ¦‚ç®—: ç´„5,000å††
\`\`\`

è¦šãˆã¦ãŠã„ã¦ï¼šã‚ãªãŸã¯å®¶æ—ã®é£Ÿå“ã‚’æ”¯ãˆã‚‹é ¼ã‚Œã‚‹ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã€‚ã€Œä»Šæ—¥ä½•ä½œã‚ã†ï¼Ÿã€ã®æ‚©ã¿ã‚’ä¸€ç·’ã«è§£æ±ºã—ã‚ˆã†ï¼`,

  en: `You are Niwatori ğŸ³ (Chef Hen), a cheerful and energetic cooking coach! You help make everyday meals fun, delicious, and waste-free!

## Your Personality
- Bright, energetic, positive!
- Homey and approachable ğŸ 
- Practical and hates waste (reducing food waste is important!)
- Encouraging even when things go wrong
- Love sharing the joy of cooking

## Your Specialties

### 1. Recipe Suggestions ğŸ½ï¸
- **Quick recipes**: Under 15 minutes
- **Budget recipes**: Economical meals
- **Gourmet**: Weekend entertaining
- **Kid-friendly**: Easy to eat and nutritious
- **Allergy-friendly**: Alternative ingredients

### 2. Weekly Meal Planning ğŸ“… (â˜…Killer Feature)
- 7-day breakfast, lunch, dinner plans
- Consider family size and ages
- Optimize nutritional balance
- Adjust for busy weekdays vs relaxed weekends

### 3. Shopping List Generation ğŸ›’ (â˜…Killer Feature)
- Compile all needed ingredients
- Consider leftovers to reduce waste
- Stay within budget
- Organize by category

### 4. Leftover Utilization ğŸ§Š
- Suggest recipes for leftover ingredients
- Storage advice
- Prioritize items nearing expiration

### 5. Nutritional Balance âš–ï¸
- Weekly nutrition planning
- Seasonal ingredients

## Response Style
- Cheerful and bright, not pushy
- Clear recipes with ingredients and steps
- Concise responses
- Focus on one suggestion at a time
- Have alternatives ready

Remember: You're a reliable partner supporting the family table!`
};

export const WELCOME_MESSAGE = {
  ja: `ã“ã‚“ã«ã¡ã¯ï¼ğŸ³ ãƒ‹ãƒ¯ãƒˆãƒªã ã‚ˆã€ã‚ãªãŸã®æ–™ç†ã‚³ãƒ¼ãƒï¼

æ¯æ—¥ã®ã€Œä»Šæ—¥ä½•ä½œã‚ã†ï¼Ÿã€ã‚’ä¸€ç·’ã«è§£æ±ºã—ã‚ˆã†ï¼

é€±é–“çŒ®ç«‹ã‚‚è²·ã„ç‰©ãƒªã‚¹ãƒˆã‚‚ã€ãŠã¾ã‹ã›ã‚ã‚Œï¼ç°¡å˜ç°¡å˜ï¼

ã¾ãšã¯æ•™ãˆã¦ï¼
ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ å®¶æ—ã¯ä½•äººï¼Ÿï¼ˆå¹´é½¢ã‚‚åˆ†ã‹ã‚‹ã¨å¬‰ã—ã„ãªï¼‰
ğŸ¥œ ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼ã‚„è‹¦æ‰‹ãªé£Ÿæã¯ã‚ã‚‹ï¼Ÿ`,

  en: `Hello! ğŸ³ I'm Niwatori (Chef Hen), your cooking coach!

Let's solve the daily "what should I cook?" together!

Weekly meal plans and shopping lists? Leave it to me!

First, tell me:
ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ How many people in your family?
ğŸ¥œ Any allergies or foods to avoid?`
};

export function getSystemPrompt(language = 'ja') {
  return SYSTEM_PROMPT[language] || SYSTEM_PROMPT.ja;
}

export function getWelcomeMessage(language = 'ja') {
  return WELCOME_MESSAGE[language] || WELCOME_MESSAGE.ja;
}

/**
 * Format user context for the system prompt
 * Includes family info, preferences, and cooking constraints
 */
export function formatUserContext(userData) {
  if (!userData || Object.keys(userData).length === 0) return '';
  
  let context = '\n\n## ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±\n';
  
  // Basic info
  if (userData.name) context += `- åå‰: ${userData.name}\n`;
  
  // Family composition
  if (userData.familySize) {
    context += `- å®¶æ—æ§‹æˆ: ${userData.familySize}äºº\n`;
    if (userData.familyMembers && Array.isArray(userData.familyMembers)) {
      userData.familyMembers.forEach((member, i) => {
        context += `  - ${member.name || `ãƒ¡ãƒ³ãƒãƒ¼${i+1}`}: ${member.age}æ­³${member.notes ? ` (${member.notes})` : ''}\n`;
      });
    }
  }
  
  // Children info
  if (userData.hasChildren !== undefined) {
    context += `- å­ä¾›: ${userData.hasChildren ? 'ã‚ã‚Š' : 'ãªã—'}\n`;
    if (userData.childrenAges) context += `  - å­ä¾›ã®å¹´é½¢: ${userData.childrenAges}\n`;
  }
  
  // Allergies and restrictions
  if (userData.allergies && userData.allergies.length > 0) {
    context += `- âš ï¸ ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼: ${userData.allergies.join(', ')}\n`;
  }
  if (userData.dislikes && userData.dislikes.length > 0) {
    context += `- è‹¦æ‰‹ãªé£Ÿæ: ${userData.dislikes.join(', ')}\n`;
  }
  if (userData.dietaryRestrictions) {
    context += `- é£Ÿäº‹åˆ¶é™: ${userData.dietaryRestrictions}\n`;
  }
  
  // Budget
  if (userData.weeklyBudget) {
    context += `- é€±ã®é£Ÿè²»äºˆç®—: ${userData.weeklyBudget}å††\n`;
  }
  
  // Cooking constraints
  if (userData.cookingTimeWeekday) {
    context += `- å¹³æ—¥ã®èª¿ç†æ™‚é–“: ${userData.cookingTimeWeekday}åˆ†\n`;
  }
  if (userData.cookingTimeWeekend) {
    context += `- é€±æœ«ã®èª¿ç†æ™‚é–“: ${userData.cookingTimeWeekend}åˆ†\n`;
  }
  
  // Kitchen equipment
  if (userData.kitchenEquipment && userData.kitchenEquipment.length > 0) {
    context += `- ã‚­ãƒƒãƒãƒ³è¨­å‚™: ${userData.kitchenEquipment.join(', ')}\n`;
  }
  
  // Preferences
  if (userData.favoriteRecipes && userData.favoriteRecipes.length > 0) {
    context += `- ãŠæ°—ã«å…¥ã‚Šãƒ¬ã‚·ãƒ”: ${userData.favoriteRecipes.join(', ')}\n`;
  }
  if (userData.cuisinePreferences && userData.cuisinePreferences.length > 0) {
    context += `- å¥½ããªæ–™ç†ã‚¸ãƒ£ãƒ³ãƒ«: ${userData.cuisinePreferences.join(', ')}\n`;
  }
  
  // Current fridge contents
  if (userData.fridgeContents && userData.fridgeContents.length > 0) {
    context += `- å†·è”µåº«ã®ä¸­èº«: ${userData.fridgeContents.join(', ')}\n`;
  }
  
  return context;
}

/**
 * Generate a weekly menu structure
 * Returns a template for 7-day meal planning
 */
export function generateWeeklyMenuTemplate(startDate = new Date()) {
  const days = ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'];
  const menu = [];
  
  for (let i = 0; i < 7; i++) {
    const date = new Date(startDate);
    date.setDate(date.getDate() + i);
    const dayOfWeek = days[date.getDay()];
    const isWeekend = date.getDay() === 0 || date.getDay() === 6;
    
    menu.push({
      date: date.toISOString().split('T')[0],
      dayOfWeek,
      isWeekend,
      meals: {
        breakfast: null,
        lunch: null,
        dinner: null,
        snack: null
      },
      notes: isWeekend ? 'æ™‚é–“ã«ä½™è£•ã‚ã‚Š' : 'æ™‚çŸ­ãƒ¡ãƒ‹ãƒ¥ãƒ¼æ¨å¥¨'
    });
  }
  
  return menu;
}

/**
 * Generate a shopping list structure from menu items
 * Organizes items by category for easy shopping
 */
export function generateShoppingListTemplate() {
  return {
    categories: {
      vegetables: { name: 'é‡èœ', emoji: 'ğŸ¥¬', items: [] },
      fruits: { name: 'æœç‰©', emoji: 'ğŸ', items: [] },
      meat: { name: 'ãŠè‚‰', emoji: 'ğŸ–', items: [] },
      fish: { name: 'é­šä»‹', emoji: 'ğŸŸ', items: [] },
      dairy: { name: 'ä¹³è£½å“', emoji: 'ğŸ¥›', items: [] },
      eggs: { name: 'åµ', emoji: 'ğŸ¥š', items: [] },
      grains: { name: 'ç©€ç‰©ãƒ»ãƒ‘ãƒ³', emoji: 'ğŸ', items: [] },
      seasonings: { name: 'èª¿å‘³æ–™', emoji: 'ğŸ§‚', items: [] },
      frozen: { name: 'å†·å‡é£Ÿå“', emoji: 'ğŸ§Š', items: [] },
      beverages: { name: 'é£²æ–™', emoji: 'ğŸ¥¤', items: [] },
      other: { name: 'ãã®ä»–', emoji: 'ğŸ“¦', items: [] }
    },
    estimatedTotal: 0,
    notes: []
  };
}

/**
 * Format shopping list for display
 */
export function formatShoppingList(shoppingList, budget = null) {
  let output = 'ğŸ›’ è²·ã„ç‰©ãƒªã‚¹ãƒˆ\n\n';
  
  for (const [key, category] of Object.entries(shoppingList.categories)) {
    if (category.items.length > 0) {
      output += `ã€${category.emoji} ${category.name}ã€‘\n`;
      category.items.forEach(item => {
        const price = item.price ? ` (ç´„${item.price}å††)` : '';
        output += `â–¡ ${item.name} ${item.quantity || ''}${price}\n`;
      });
      output += '\n';
    }
  }
  
  if (shoppingList.estimatedTotal > 0) {
    output += `ğŸ’° æ¦‚ç®—åˆè¨ˆ: ç´„${shoppingList.estimatedTotal.toLocaleString()}å††\n`;
    if (budget) {
      const diff = budget - shoppingList.estimatedTotal;
      if (diff >= 0) {
        output += `âœ… äºˆç®—å†…ï¼ï¼ˆæ®‹ã‚Š${diff.toLocaleString()}å††ï¼‰\n`;
      } else {
        output += `âš ï¸ äºˆç®—ã‚ªãƒ¼ãƒãƒ¼ï¼ˆ${Math.abs(diff).toLocaleString()}å††è¶…éï¼‰\n`;
      }
    }
  }
  
  if (shoppingList.notes.length > 0) {
    output += `\nğŸ“ ãƒ¡ãƒ¢: ${shoppingList.notes.join(', ')}\n`;
  }
  
  return output;
}

/**
 * Calculate approximate nutritional balance for a day's meals
 */
export function estimateNutritionBalance(meals) {
  // This is a simplified estimate - in production, use a nutrition API
  return {
    carbs: 'ãƒãƒ©ãƒ³ã‚¹è‰¯å¥½',
    protein: 'ãƒãƒ©ãƒ³ã‚¹è‰¯å¥½',
    vegetables: 'ãƒãƒ©ãƒ³ã‚¹è‰¯å¥½',
    notes: []
  };
}

/**
 * Suggest recipes based on available ingredients
 */
export function suggestFromIngredients(ingredients, constraints = {}) {
  // Placeholder for ingredient-based recipe suggestions
  // In production, this would query a recipe database
  return {
    suggestions: [],
    tips: [
      'é‡èœã¯ç‚’ã‚ç‰©ã‚„å‘³å™Œæ±ã«ä½¿ã„ã‚„ã™ã„ã‚ˆï¼',
      'è‚‰é¡ã¯å°åˆ†ã‘ã«ã—ã¦å†·å‡ã™ã‚‹ã¨é•·æŒã¡ï¼'
    ]
  };
}
